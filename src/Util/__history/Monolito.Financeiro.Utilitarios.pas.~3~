unit Monolito.Financeiro.Utilitarios;

interface

uses
  Vcl.DBGrids;
type
  TUtilitarios = class
    class Function GetID : String;
    class function LikeFind(Pesquisa: String; Grid: TDBGrid): string;
  end;
implementation

{ TUtilitarios }

uses
  System.SysUtils;

class function TUtilitarios.GetID: String;
begin
  Result := TGuid.NewGuid.ToString;
  Result := StringReplace(Result, '{', '',[rfReplaceAll]);
  Result := StringReplace(Result, '}', '',[rfReplaceAll]);
end;

class function TUtilitarios.LikeFind(Pesquisa: String; Grid: TDBGrid): string;
var
  LContador: Integer;
begin
  Result := '';
  if Pesquisa.Trim.IsEmpty then
    exit;
  for LContador := 0 to Pred(Grid.Columns.Count) do
  begin
    Result := Result + Grid.Columns.Items[LContador].FieldName +
      ' LIKE ' + QuotedStr('%' + Trim(Pesquisa) + '%') + ' OR ';
  end;
end;

end.
